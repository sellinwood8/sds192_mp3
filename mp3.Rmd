---
title: "Mini Project 3"
author: "Sam Ellinwood"
date: "11/8/2017"
output: html_document
---

test
```{r, message = FALSE}
library(mdsr)
library(RMySQL)
db <- dbConnect_scidb(dbname = "imdb")
db %>%
  dbGetQuery("SELECT * FROM kind_type;")
```

```{r}
#Selecting querey 

db %>%
  dbGetQuery(
"SELECT *
FROM (SELECT linked_movie_id AS original_id, movie_link.movie_id AS sequel_id,  
	link_type_id, production_year AS sequel_year FROM imdb.movie_link
JOIN aka_title ON movie_link.movie_id = aka_title.id
WHERE link_type_id = 1 OR link_type_id = 3 OR link_type_id = 11 
	OR link_type_id = 13 OR link_type_id = 16) as sequel_table, 
    (SELECT linked_movie_id AS original_id,movie_link.linked_movie_id AS sequel_id,  
	link_type_id, production_year AS original_year FROM imdb.movie_link
JOIN aka_title ON movie_link.linked_movie_id = aka_title.movie_id
WHERE link_type_id = 2 OR link_type_id = 4 OR link_type_id = 15) 
	as original_table
WHERE sequel_table.original_id = original_table.original_id;
")
```


